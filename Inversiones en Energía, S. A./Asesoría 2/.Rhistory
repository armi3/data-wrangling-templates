library(tidyverse)
library(lubridate)
#' IMPORTAR DATOS
df <- read.csv("/Users/baroness/Documents/201802/CS-DS001 Data Wrangling (A)/Lab04/c1.csv")
#' EXPLORAR
View(df)
#' HACER TIDY
df <- df[1:22] %>%
dplyr::mutate_all(toupper) %>%
dplyr::mutate_all(str_trim) %>%
dplyr::na_if("") %>%
tidyr::gather(key="DURACIÓN", value="FRECUENCIA", 18:22, na.rm=TRUE)
df <- df[1:18] %>%
dplyr::mutate(Moto = as.numeric(gsub("Q", "", df$Moto)),
Pickup = as.numeric(gsub("Q", "", df$Pickup)),
Camion_5 = as.numeric(gsub("Q", "", df$Camion_5)),
fijoMoto = as.numeric(gsub("Q", "", df$fijoMoto)),
fijoPickup = as.numeric(gsub("Q", "", df$fijoPickup)),
fijoCamion_5 = as.numeric(gsub("Q", "", df$fijoCamion_5)),
directoMoto = as.numeric(gsub("Q", "", df$directoMoto)),
directoPickup = as.numeric(gsub("Q", "", df$directoPickup)),
directoCamion_5 = as.numeric(gsub("Q", "", df$directoCamion_5)),
factura = as.numeric(gsub("Q", "", df$factura)),
DURACIÓN = as.character(gsub("X", "", df$DURACIÓN))) %>%
tidyr::gather(key="VEHÍCULO", value="COSTO OPERACIONAL TOTAL", 3:5, na.rm=TRUE) %>%
tidyr::gather(key="DV", value="COSTO OPERACIONAL DIRECTO", directoCamion_5:directoMoto, na.rm=TRUE) %>%
tidyr::gather(key="DF", value="COSTO OPERACIONAL FIJO", fijoCamion_5:fijoMoto, na.rm=TRUE)
df$DV<-NULL
df$DF<-NULL
df <- tidyr::separate(df, DURACIÓN, c('DUR MIN', 'DUR MÁX'), sep="([.])+")
mov_demanda <- df[1:3]%>%
dplyr::mutate(SEMANA=lubridate::floor_date(dmy(Fecha), "8 days"))%>%
dplyr::group_by(MES=lubridate::month(Fecha, label=TRUE))%>%
dplyr::summarise("W1"=sum(str_count(as.character(day(SEMANA)), "1")),
"W2"=sum(str_count(as.character(day(SEMANA)), "9")),
"W3"=sum(str_count(as.character(day(SEMANA)), "17")),
"W4"=sum(str_count(as.character(day(SEMANA)), "25")))
View(mov_demanda)
write.csv(mov_demanda,"mov_demanda.csv")
#' IMPORTAR DATOS
df <- read.csv("/Users/baroness/Documents/201802/CS-DS001 Data Wrangling (A)/Lab04/c1.csv")
View(df)
unique(df$Cod)
#' TRANSFORMAR
servicios_mensuales <- df[1:3]%>%
dplyr::group_by(MES=lubridate::month(Fecha, label=TRUE))%>%
dplyr::summarise("PREVENTIVO"=sum(str_count(Cod, "VERIFICACION_MEDIDORES"),
str_count(Cod, "REVISION"),
str_count(Cod, "VERIFICACION_INDICADORES")),
"CORRECTIVO"=sum(str_count(Cod, "CAMBIO"),
str_count(Cod, "VISITA_POR_CORRECCION")),
"OTRO"=sum(str_count(Cod, "OTRO"),
str_count(Cod, "VISITA")))
write.csv(servicios_mensuales,"servicios_mensuales.csv")
#' PREPARAR AMBIENTE DE TRABAJO
install.packages("tidyverse")
library(tidyverse)
library(lubridate)
#' IMPORTAR DATOS
df <- read.csv("/Users/baroness/Documents/201802/CS-DS001 Data Wrangling (A)/Lab04/c1.csv")
#' EXPLORAR
View(df)
#' HACER TIDY
df <- df[1:22] %>%
dplyr::mutate_all(toupper) %>%
dplyr::mutate_all(str_trim) %>%
dplyr::na_if("") %>%
tidyr::gather(key="DURACIÓN", value="FRECUENCIA", 18:22, na.rm=TRUE)
df <- df[1:18] %>%
dplyr::mutate(Moto = as.numeric(gsub("Q", "", df$Moto)),
Pickup = as.numeric(gsub("Q", "", df$Pickup)),
Camion_5 = as.numeric(gsub("Q", "", df$Camion_5)),
fijoMoto = as.numeric(gsub("Q", "", df$fijoMoto)),
fijoPickup = as.numeric(gsub("Q", "", df$fijoPickup)),
fijoCamion_5 = as.numeric(gsub("Q", "", df$fijoCamion_5)),
directoMoto = as.numeric(gsub("Q", "", df$directoMoto)),
directoPickup = as.numeric(gsub("Q", "", df$directoPickup)),
directoCamion_5 = as.numeric(gsub("Q", "", df$directoCamion_5)),
factura = as.numeric(gsub("Q", "", df$factura)),
DURACIÓN = as.character(gsub("X", "", df$DURACIÓN))) %>%
tidyr::gather(key="VEHÍCULO", value="COSTO OPERACIONAL TOTAL", 3:5, na.rm=TRUE) %>%
tidyr::gather(key="DV", value="COSTO OPERACIONAL DIRECTO", directoCamion_5:directoMoto, na.rm=TRUE) %>%
tidyr::gather(key="DF", value="COSTO OPERACIONAL FIJO", fijoCamion_5:fijoMoto, na.rm=TRUE)
df$DV<-NULL
df$DF<-NULL
df <- tidyr::separate(df, DURACIÓN, c('DUR MIN', 'DUR MÁX'), sep="([.])+")
#' TRANSFORMAR
servicios_mensuales <- df[1:3]%>%
dplyr::group_by(MES=lubridate::month(Fecha, label=TRUE))%>%
dplyr::summarise("PREVENTIVO"=sum(str_count(Cod, "VERIFICACION_MEDIDORES"),
str_count(Cod, "REVISION"),
str_count(Cod, "VERIFICACION_INDICADORES")),
"CORRECTIVO"=sum(str_count(Cod, "CAMBIO"),
str_count(Cod, "VISITA_POR_CORRECCION")),
"OTRO"=sum(str_count(Cod, "OTRO"),
str_count(Cod, "VISITA")))
head(servicios_mensuales)
write.csv(servicios_mensuales,"servicios_mensuales.csv")
#' TRANSFORMAR
servicios_mensuales <- df[1:3]%>%
dplyr::group_by(MES=lubridate::month(Fecha, label=TRUE))%>%
dplyr::summarise("PREVENTIVO"=sum(str_count(Cod, "VERIFICACION"),
str_count(Cod, "REVISION")),
"CORRECTIVO"=sum(str_count(Cod, "CAMBIO"),
str_count(Cod, "CORRECCION")),
"OTRO"=sum(str_count(Cod, "OTRO"),
str_count(Cod, "VISITA")))
head(servicios_mensuales)
write.csv(servicios_mensuales,"servicios_mensuales.csv")
#' TRANSFORMAR
servicios_mensuales <- df[1:3]%>%
dplyr::group_by(MES=lubridate::month(Fecha, label=TRUE))%>%
dplyr::summarise("PREVENTIVO"=sum(str_count(Cod, fixed("VERIFICACION")),
str_count(Cod, fixed("REVISION"))),
"CORRECTIVO"=sum(str_count(Cod, fixed("CAMBIO")),
str_count(Cod, fixed("CORRECCION"))),
"OTRO"=sum(str_count(Cod, fixed("OTRO")),
str_count(Cod, fixed("VISITA"))))
head(servicios_mensuales)
write.csv(servicios_mensuales,"servicios_mensuales.csv")
#' TRANSFORMAR
servicios_mensuales <- df[1:3]%>%
dplyr::group_by(MES=lubridate::month(Fecha, label=TRUE))%>%
dplyr::summarise_all("PREVENTIVO"=sum(str_count(Cod, fixed("VERIFICACION")),
str_count(Cod, fixed("REVISION"))),
"CORRECTIVO"=sum(str_count(Cod, fixed("CAMBIO")),
str_count(Cod, fixed("CORRECCION"))),
"OTRO"=sum(str_count(Cod, fixed("OTRO")),
str_count(Cod, fixed("VISITA"))))
#' TRANSFORMAR
servicios_mensuales <- df[1:3]%>%
dplyr::group_by(MES=lubridate::month(Fecha, label=TRUE))%>%
dplyr::summarise_all("PREVENTIVO"=sum(str_count(df$Cod, fixed("VERIFICACION")),
str_count(df$Cod, fixed("REVISION"))),
"CORRECTIVO"=sum(str_count(df$Cod, fixed("CAMBIO")),
str_count(df$Cod, fixed("CORRECCION"))),
"OTRO"=sum(str_count(df$Cod, fixed("OTRO")),
str_count(df$Cod, fixed("VISITA"))))
#' TRANSFORMAR
servicios_mensuales <- df[1:3]%>%
dplyr::group_by(MES=lubridate::month(Fecha, label=TRUE))%>%
dplyr::count(Cod)
head(servicios_mensuales)
unique(df$Cod)
df <- df%>%
dplyr::mutate(CÓDIGO = dplyr::case_when(Cod=="REVISION_TRANSFORMADOR" ~ "PREVENTIVO",
Cod=="REVISION" ~ "PREVENTIVO",
Cod=="VERIFICACION_INDICADORES" ~ "PREVENTIVO",
Cod=="VERIFICACION_MEDIDORES" ~ "PREVENTIVO",
TRUE ~ CÓDIGO)) %>%
#' TRANSFORMAR
servicios_mensuales <- df[1:3]%>%
dplyr::group_by(MES=lubridate::month(Fecha, label=TRUE))%>%
dplyr::count(Cod)
df <- df%>%
dplyr::mutate("CÓDIGO" = dplyr::case_when(Cod=="REVISION_TRANSFORMADOR" ~ "PREVENTIVO",
Cod=="REVISION" ~ "PREVENTIVO",
Cod=="VERIFICACION_INDICADORES" ~ "PREVENTIVO",
Cod=="VERIFICACION_MEDIDORES" ~ "PREVENTIVO",
TRUE ~ CÓDIGO)) %>%
#' TRANSFORMAR
servicios_mensuales <- df[1:3]%>%
dplyr::group_by(MES=lubridate::month(Fecha, label=TRUE))%>%
dplyr::count(Cod)
df <- df%>%
dplyr::mutate("CÓDIGO" = dplyr::case_when(Cod=="REVISION_TRANSFORMADOR" ~ "PREVENTIVO",
Cod=="REVISION" ~ "PREVENTIVO",
Cod=="VERIFICACION_INDICADORES" ~ "PREVENTIVO",
Cod=="VERIFICACION_MEDIDORES" ~ "PREVENTIVO",
TRUE ~ "CÓDIGO")) %>%
#' TRANSFORMAR
servicios_mensuales <- df[1:3]%>%
dplyr::group_by(MES=lubridate::month(Fecha, label=TRUE))%>%
dplyr::count(Cod)
library(tidyverse)
library(lubridate)
unique(df$Cod)
df <- df %>%
dplyr::mutate("CÓDIGO" = dplyr::case_when(Cod=="REVISION_TRANSFORMADOR" ~ "PREVENTIVO",
Cod=="REVISION" ~ "PREVENTIVO",
Cod=="VERIFICACION_INDICADORES" ~ "PREVENTIVO",
Cod=="VERIFICACION_MEDIDORES" ~ "PREVENTIVO",
TRUE ~ "CÓDIGO")) %>%
#' TRANSFORMAR
servicios_mensuales <- df[1:3]%>%
dplyr::group_by(MES=lubridate::month(Fecha, label=TRUE))%>%
dplyr::count(Cod)
df <- df %>%
dplyr::mutate("CÓDIGO" = dplyr::case_when(Cod=="REVISION_TRANSFORMADOR" ~ "PREVENTIVO",
Cod=="REVISION" ~ "PREVENTIVO",
Cod=="VERIFICACION_INDICADORES" ~ "PREVENTIVO",
Cod=="VERIFICACION_MEDIDORES" ~ "PREVENTIVO",
TRUE ~ "CÓDIGO"))
unique(df$Cod)
unique(df$CÓDIGO)
df <- df %>%
dplyr::mutate("CÓDIGO" = dplyr::case_when(Cod=="REVISION_TRANSFORMADOR" ~ "PREVENTIVO",
Cod=="REVISION" ~ "PREVENTIVO",
Cod=="VERIFICACION_INDICADORES" ~ "PREVENTIVO",
Cod=="VERIFICACION_MEDIDORES" ~ "PREVENTIVO",
Cod=="VISITA_POR_CORRECCION" ~ "CORRECTIVO",
Cod=="CAMBIO_CORRECTIVO" ~ "CORRECTIVO",
Cod=="CAMBIO_FUSIBLE" ~ "CORRECTIVO",
Cod=="CAMBIO_PUENTES" ~ "CORRECTIVO",
Cod=="OTRO" ~ "OTRO",
Cod=="VISITA" ~ "OTRO",
TRUE ~ Cod))%>%
dplyr::select(-Cod)
unique(df$CÓDIGO)
#' TRANSFORMAR
servicios_mensuales <- df[1:3]%>%
dplyr::group_by(MES=lubridate::month(Fecha, label=TRUE))%>%
dplyr::count(Cod)
head(servicios_mensuales)
#' TRANSFORMAR
servicios_mensuales <- df[1:3]%>%
dplyr::group_by(MES=lubridate::month(Fecha, label=TRUE))%>%
dplyr::count(CÓDIGO)
View(df)
#' TRANSFORMAR
servicios_mensuales <- df[Fecha, CÓDIGO]%>%
dplyr::group_by(MES=lubridate::month(Fecha, label=TRUE))%>%
dplyr::count(CÓDIGO)
#' TRANSFORMAR
servicios_mensuales <- df%>%
dplyr::select(Fecha, CÓDIGO)%>%
dplyr::group_by(MES=lubridate::month(Fecha, label=TRUE))%>%
dplyr::count(CÓDIGO)
head(servicios_mensuales)
#' TRANSFORMAR
servicios_mensuales <- df%>%
dplyr::select(Fecha, CÓDIGO)%>%
dplyr::group_by(MES=lubridate::month(Fecha, label=TRUE))%>%
dplyr::count(CÓDIGO)
head(servicios_mensuales)
servicios_diarios <- df%>%
dplyr::select(Fecha, CÓDIGO)%>%
dplyr::group_by(WEEKDAY=lubridate::wday(Fecha, label=TRUE))%>%
dplyr::count(CÓDIGO)
head(servicios_diarios)
services_turnover <- df%>%
dplyr::select(Fecha, CÓDIGO)%>%
dplyr::group_by(CÓDIGO)%>%
dplyr::count()%>%
dplyr::mutate(TURNOVER=n/365)
head(services_turnover)
mov_demanda <- df%>%
dplyr::select(Fecha, CÓDIGO)%>%
dplyr::mutate(SEMANA=lubridate::floor_date(dmy(Fecha), "8 days"))%>%
dplyr::group_by(MES=lubridate::month(Fecha, label=TRUE))%>%
dplyr::summarise("W1"=sum(str_count(as.character(day(SEMANA)), "1")),
"W2"=sum(str_count(as.character(day(SEMANA)), "9")),
"W3"=sum(str_count(as.character(day(SEMANA)), "17")),
"W4"=sum(str_count(as.character(day(SEMANA)), "25")))
View(mov_demanda)
mov_demanda <- df%>%
dplyr::select(Fecha, CÓDIGO)%>%
dplyr::mutate(SEMANA=lubridate::floor_date(dmy(Fecha), "8 days"))%>%
dplyr::group_by(MES=lubridate::month(Fecha, label=TRUE))%>%
dplyr::summarise("W1"=str_count(as.character(day(SEMANA)), "1"),
"W2"=str_count(as.character(day(SEMANA)), "9"),
"W3"=str_count(as.character(day(SEMANA)), "17"),
"W4"=str_count(as.character(day(SEMANA)), "25"))
dplyr::summarise("W1"=sum(case_when(day(SEMANA)==1)),
"W2"=sum(str_count(as.character(day(SEMANA)), "9")),
"W3"=sum(str_count(as.character(day(SEMANA)), "17")),
"W4"=sum(str_count(as.character(day(SEMANA)), "25")))
mov_demanda <- df%>%
dplyr::select(Fecha, CÓDIGO)%>%
dplyr::mutate(SEMANA=lubridate::floor_date(dmy(Fecha), "8 days"))%>%
dplyr::group_by(MES=lubridate::month(Fecha, label=TRUE))%>%
dplyr::summarise("W1"=sum(case_when(day(SEMANA)==1)),
"W2"=sum(str_count(as.character(day(SEMANA)), "9")),
"W3"=sum(str_count(as.character(day(SEMANA)), "17")),
"W4"=sum(str_count(as.character(day(SEMANA)), "25")))
mov_demanda <- df%>%
dplyr::select(Fecha, CÓDIGO)%>%
dplyr::mutate(SEMANA=lubridate::floor_date(dmy(Fecha), "8 days"))%>%
dplyr::group_by(MES=lubridate::month(Fecha, label=TRUE))%>%
dplyr::summarise("W1"=sum(n(lubridate::day(SEMANA)==1)),
"W2"=sum(str_count(as.character(day(SEMANA)), "9")),
"W3"=sum(str_count(as.character(day(SEMANA)), "17")),
"W4"=sum(str_count(as.character(day(SEMANA)), "25")))
mov_demanda <- df%>%
dplyr::select(Fecha, CÓDIGO)%>%
dplyr::mutate(SEMANA=lubridate::floor_date(dmy(Fecha), "8 days"))%>%
dplyr::group_by(MES=lubridate::month(Fecha, label=TRUE))%>%
dplyr::summarise("W1"=sum(lubridate::day(SEMANA)==1),
"W2"=sum(str_count(as.character(day(SEMANA)), "9")),
"W3"=sum(str_count(as.character(day(SEMANA)), "17")),
"W4"=sum(str_count(as.character(day(SEMANA)), "25")))
mov_demanda <- df%>%
dplyr::select(Fecha, CÓDIGO)%>%
dplyr::mutate(SEMANA=lubridate::floor_date(dmy(Fecha), "8 days"))%>%
dplyr::group_by(MES=lubridate::month(Fecha, label=TRUE))%>%
dplyr::summarise("W1"=sum(lubridate::day(SEMANA)==1),
"W2"=sum(lubridate::day(SEMANA)==9),
"W3"=sum(lubridate::day(SEMANA)==17),
"W4"=sum(lubridate::day(SEMANA)==25))
View(mov_demanda)
#' TRANSFORMAR
servicios_mensuales <- df%>%
dplyr::select(Fecha, CÓDIGO)%>%
dplyr::group_by(MES=lubridate::month(Fecha, label=TRUE))%>%
dplyr::count(CÓDIGO)
head(servicios_mensuales)
servicios_diarios <- df%>%
dplyr::select(Fecha, CÓDIGO)%>%
dplyr::group_by(WEEKDAY=lubridate::wday(Fecha, label=TRUE))%>%
dplyr::count(CÓDIGO)
head(servicios_diarios)
services_turnover <- df%>%
dplyr::select(Fecha, CÓDIGO)%>%
dplyr::group_by(CÓDIGO)%>%
dplyr::count()%>%
dplyr::mutate(TURNOVER=n/365)
head(services_turnover)
mov_demanda <- df%>%
dplyr::select(Fecha, CÓDIGO)%>%
dplyr::mutate(SEMANA=lubridate::floor_date(dmy(Fecha), "8 days"))%>%
dplyr::group_by(MES=lubridate::month(Fecha, label=TRUE))%>%
dplyr::summarise("W1"=sum(lubridate::day(SEMANA)==1),
"W2"=sum(lubridate::day(SEMANA)==9),
"W3"=sum(lubridate::day(SEMANA)==17),
"W4"=sum(lubridate::day(SEMANA)==25))
View(mov_demanda)
write.csv(servicios_mensuales,"servicios_mensuales.csv")
write.csv(servicios_diarios,"servicios_diarios.csv")
write.csv(services_turnover,"services_turnover.csv")
write.csv(mov_demanda,"mov_demanda.csv")
df <- data.frame(row=LETTERS[1:3], a=1:3, b=4:6, c=7:9)
#' IMPORTAR DATOS
df <- read.csv("/Users/baroness/Documents/201802/CS-DS001 Data Wrangling (A)/Lab04/c1.csv")
#' IMPORTAR DATOS
df <- read.csv("/Users/baroness/Documents/201802/CS-DS001 Data Wrangling (A)/Lab04/c1.csv")
#' HACER TIDY
df <- df[1:22] %>%
dplyr::mutate_all(toupper) %>%
dplyr::mutate_all(str_trim) %>%
dplyr::na_if("") %>%
tidyr::gather(key="DURACIÓN", value="FRECUENCIA", 18:22, na.rm=TRUE)
df <- df[1:18] %>%
dplyr::mutate(Moto = as.numeric(gsub("Q", "", df$Moto)),
Pickup = as.numeric(gsub("Q", "", df$Pickup)),
Camion_5 = as.numeric(gsub("Q", "", df$Camion_5)),
fijoMoto = as.numeric(gsub("Q", "", df$fijoMoto)),
fijoPickup = as.numeric(gsub("Q", "", df$fijoPickup)),
fijoCamion_5 = as.numeric(gsub("Q", "", df$fijoCamion_5)),
directoMoto = as.numeric(gsub("Q", "", df$directoMoto)),
directoPickup = as.numeric(gsub("Q", "", df$directoPickup)),
directoCamion_5 = as.numeric(gsub("Q", "", df$directoCamion_5)),
factura = as.numeric(gsub("Q", "", df$factura)),
DURACIÓN = as.character(gsub("X", "", df$DURACIÓN))) %>%
tidyr::gather(key="VEHÍCULO", value="COSTO OPERACIONAL TOTAL", 3:5, na.rm=TRUE) %>%
tidyr::gather(key="DV", value="COSTO OPERACIONAL DIRECTO", directoCamion_5:directoMoto, na.rm=TRUE) %>%
tidyr::gather(key="DF", value="COSTO OPERACIONAL FIJO", fijoCamion_5:fijoMoto, na.rm=TRUE)
df$DV<-NULL
df$DF<-NULL
df <- tidyr::separate(df, DURACIÓN, c('DUR MIN', 'DUR MÁX'), sep="([.])+")
unique(df$CÓDIGO)
df <- df %>%
dplyr::mutate("CÓDIGO" = dplyr::case_when(Cod=="REVISION_TRANSFORMADOR" ~ "PREVENTIVO",
Cod=="REVISION" ~ "PREVENTIVO",
Cod=="VERIFICACION_INDICADORES" ~ "PREVENTIVO",
Cod=="VERIFICACION_MEDIDORES" ~ "PREVENTIVO",
Cod=="VISITA_POR_CORRECCION" ~ "CORRECTIVO",
Cod=="CAMBIO_CORRECTIVO" ~ "CORRECTIVO",
Cod=="CAMBIO_FUSIBLE" ~ "CORRECTIVO",
Cod=="CAMBIO_PUENTES" ~ "CORRECTIVO",
Cod=="OTRO" ~ "OTRO",
Cod=="VISITA" ~ "OTRO",
TRUE ~ Cod))%>%
dplyr::select(-Cod)
df1 <- data.frame(row=LETTERS[1:3], a=1:3, b=4:6, c=7:9)
df1 <- tidyr::gather(df, key="variable", value="value", a:c)
head(df1)
df1 <- tidyr::gather(df1, key="variable", value="value", a:c)
head(df1)
#' IMPORTAR DATOS
rawdf <- read.csv("/Users/baroness/Documents/201802/CS-DS001 Data Wrangling (A)/Clase06/raw.csv")
View(rawdf)
head(servicios_mensua
head(servicios_mensuales)
head(servicios_mensuales)
#' TRANSFORMAR
servicios_mensuales <- df%>%
dplyr::select(Fecha, CÓDIGO)%>%
dplyr::group_by(MES=lubridate::month(Fecha, label=TRUE))%>%
dplyr::count(CÓDIGO)%>%
tidyr::spread(MES, n)
head(servicios_mensuales)
#' TRANSFORMAR
servicios_mensuales <- df%>%
dplyr::select(Fecha, CÓDIGO)%>%
dplyr::group_by(MES=lubridate::month(Fecha, label=TRUE))%>%
dplyr::count(CÓDIGO)%>%
tidyr::spread(CÓDIGO, n)
head(servicios_mensuales)
#' TRANSFORMAR
servicios_mensuales <- df%>%
dplyr::select(Fecha, CÓDIGO)%>%
dplyr::group_by(MES=lubridate::month(Fecha, label=TRUE))%>%
dplyr::count(CÓDIGO)%>%
tidyr::spread(MES, n)
servicios_diarios <- df%>%
dplyr::select(Fecha, CÓDIGO)%>%
dplyr::group_by(WEEKDAY=lubridate::wday(Fecha, label=TRUE))%>%
dplyr::count(CÓDIGO)%>%
tidyr::spread(MES, n)
head(servicios_mensuales)
head(servicios_diarios)
servicios_diarios <- df%>%
dplyr::select(Fecha, CÓDIGO)%>%
dplyr::group_by(WEEKDAY=lubridate::wday(Fecha, label=TRUE))%>%
dplyr::count(CÓDIGO)%>%
tidyr::spread(WEEKDAY, n)
head(servicios_diarios)
write.csv(servicios_mensuales,"servicios_mensuales.csv")
write.csv(servicios_diarios,"servicios_diarios.csv")
